<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js">
    </script>
    <script>

        function loadXMLDoc() {
            var xmlhttp;
            if (window.XMLHttpRequest) {
                //  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
                xmlhttp = new XMLHttpRequest();
            }
            else {
                // IE6, IE5 浏览器执行代码
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == (200 || 304)) {
                    document.getElementById("image-back").src = xmlhttp.responseText;
                    document.getElementById("image-back").alt = "ok";
                }
            }
            xmlhttp.open("GET", "/imgBack", true);
            xmlhttp.send();
        }

    </script>
</head>

<body>
    <div style="width:390px;height:280px; background:#CCCCCC; float:left;">
        <img id="image" src="#" style="width:100%; object-fit: cover;" alt="test" />
    </div>
    <form action="/upImg" enctype="multipart/form-data" method="post">
        <input type="file" id="file" name="image" onchange="fileSelect(this)" />
        <input type="button" value="submit" onclick="imgPost()">
    </form>
    <div style="width:390px;height:280px; background:#CCCCCC; float:left;">
        <img id="image-back" src="#" style="width:100%; object-fit: cover;" alt="test" />
    </div>
    <button type="button" onclick="loadXMLDoc()">Process</button>

</body>
<script>
    function fileSelect(obj) {
        var imgFile = obj.files[0];
        var fr = new FileReader();
        fr.onload = function () {
            document.getElementById('image').src = fr.result;
        };
        fr.readAsDataURL(imgFile);
    }

    function imgPost() {
        var fd = new FormData();
        var img = document.getElementById("file").files[0];
        fd.append("image", img);
        $.ajax({
            url: '/upImg',
            type: 'POST',
            cache: false,
            data: fd,
            processData: false,
            contentType: false,
            success: function(data) {
                alert("upload success");
            },
            error: function(data) {
                alert("upload failed");
            }
        })
    }
</script>

</html>